---
title: "Summary and visualizations"
---


<style type="text/css">
.main-container {
    max-width: 1170px;
    
}
</style>



```{r, include=FALSE, echo=FALSE}
library(tidyverse)
library(lingtypology)
library(readr)
library(DT)

df_orig <- read.csv("data.csv", na.strings=c("","NA"))
df_orig %>%
  filter(truth_word == "yes") %>%
  select(-"id_number", -"researcher", -"iso", -"family", -"consultant", -"questionnaire_language", -"elicitation_method", -"truth_word", -"word_group", -"really_pred_excluded") %>%
  select(-contains("_comment"))-> df


df %>%
  mutate(across(.cols = c(4:ncol(df)), .fns = function(x) ifelse(!is.na(x), "+", ""))) -> df

```


## Questionnaire results {.tabset}

### All functions

```{r echo = FALSE, results = 'asis', message=FALSE, warning=FALSE}
datatable(
  data = df,
  filter = "top",
  extensions = 'FixedColumns',
  options = list(fixedColumns = list(leftColumns = 4), scrollX = TRUE, dom = 'Bfrtip',
                 columnDefs = list(list(className = 'dt-center', targets = "_all")))
  
)
```

---


### Generalized extended functions


```{r, include=FALSE, echo=FALSE}
df %>%
  mutate(int = ifelse(int_attr == "+" | int_nonvpred == "+" | int_pred == "+",
                        "+", "")) %>%
  mutate(contrast = ifelse(contrast_clausal1 == "+" | contrast_clausal2 == "+" | contrast_attr == "+" | contrast_adv == "+",
                        "+", "")) %>%
  mutate(contrast_attr_adv = ifelse(contrast_attr == "+" | contrast_adv == "+",
                        "+", "")) %>%
  select("language_name", "word", "translation", "int", "tag", "affirm", "contrast", "contrast_attr_adv", "subjectification") -> df_gen
df_gen
```

```{r echo = FALSE, results = 'asis', message=FALSE, warning=FALSE}
datatable(
  data = df_gen,
  filter = "top",
  extensions = 'FixedColumns',
  options = list(scrollX = TRUE, dom = 'Bfrtip',
                 columnDefs = list(list(className = 'dt-center', targets = "_all")))
  
)
```

---

## Maps 

### All functions {.tabset}

```{r, include=FALSE, echo=FALSE}
df %>%
  group_by(language_name) %>%
  summarize(across(truth:subjectification, ~ ifelse(("+" %in% .x), "attested", "not attested"))) -> df_per_lng

#restore iso-codes
df_orig %>%
  select("language_name", "iso") %>%
  unique() -> iso_codes
df_iso <- merge (df_per_lng, iso_codes, by = "language_name")
```


#### correct

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$correct,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "\'correct\'"
            )
```

#### real_not_fake

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$real_not_fake,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "\'real (not fake)\'"
            )
```

#### real_not_imagined

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$real_not_imagined,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "\'real (not imagined)\'"
            )
```


#### int_attr

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$int_attr,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "intensification (of attribute)"
            )
```


#### int_nonvpred

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$int_nonvpred,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "intensification (of non-verbal predicate)"
            )
```

#### int_pred

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$int_pred,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "intensification (of verbal predicate)"
            )
```


#### counter-loosener

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$counter_loosener,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "counter-loosener (\'proper\')"
            )
```

#### selective

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$selective,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "selective (\'the only real\')"
            )
```

#### tag

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$tag,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "tag-question"
            )
```

#### affirm

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$affirm,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "affirmation"
            )
```

#### contrast_clausal1

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$contrast_clausal1,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "contrast (It is true that P, but Q)"
            )
```

#### contrast_clausal2

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$contrast_clausal2,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "contrast (Q, but the truth is that P)"
            )
```



#### contrast_attr

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$contrast_attr,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "contrast (+ attribute)"
            )
```

#### contrast_adv

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$contrast_adv,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "contrast (+ adverbial)"
            )
```



#### subjectification

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_iso$iso),
            features = df_iso$subjectification,
            label = df_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "subjectification"
            )
```

---

### Generalized extended functions {.tabset}

```{r, include=FALSE, echo=FALSE}
df_gen %>%
  group_by(language_name) %>%
  summarize(across(int:subjectification, ~ ifelse(("+" %in% .x), "attested", "not attested"))) -> df_per_lng

#restore iso-codes
df_orig %>%
  select("language_name", "iso") %>%
  unique() -> iso_codes
df_gen_iso <- merge (df_per_lng, iso_codes, by = "language_name")
```




```{r, echo=FALSE, include=FALSE}
#for neighbbor-net
df %>%
  group_by(language_name) %>%
  summarize(across(correct:subjectification, ~ ifelse(("+" %in% .x), "1", "0"))) -> df
write.csv(df, "df.csv")
```



#### Intensification

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_gen_iso$iso),
            features = df_gen_iso$int,
            label = df_gen_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "Intensification"
            )
```


#### Tag-question

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_gen_iso$iso),
            features = df_gen_iso$tag,
            label = df_gen_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "Tag-question"
            )
```

#### Affirmation

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_gen_iso$iso),
            features = df_gen_iso$affirm,
            label = df_gen_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "Affirmation"
            )
```


#### Contrast

```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_gen_iso$iso),
            features = df_gen_iso$contrast,
            label = df_gen_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "Contrast"
            )
```


#### Clause-internal contrast

```{r, echo=FALSE, out.width = '100%'}

map.feature(languages = lang.iso(df_gen_iso$iso),
            features = df_gen_iso$contrast_attr_adv,
            label = df_gen_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "clause-internal contrast"
            )
```


#### Subjectification


```{r, echo=FALSE, out.width = '100%'}
  
map.feature(languages = lang.iso(df_gen_iso$iso),
            features = df_gen_iso$subjectification,
            label = df_gen_iso$iso, label.hide = FALSE, label.fsize = 10,
            tile = "Esri.WorldPhysical",
            color = c("#f46d43", "#404040"),
            width = 6,
            title = "Subjectification"
            )
```




